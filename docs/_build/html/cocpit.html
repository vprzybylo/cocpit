<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cocpit package &mdash; COCPIT 2.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->

        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="data" href="modules.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> COCPIT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">data</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">cocpit package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.add_date">cocpit.add_date module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.auto_str">cocpit.auto_str module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.data_loaders">cocpit.data_loaders module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.geometry">cocpit.geometry module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cocpit-geometry-runner-module">cocpit.geometry_runner module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.fold_setup">cocpit.fold_setup module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.gui">cocpit.gui module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.gui_label">cocpit.gui_label module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.gui_wrong">cocpit.gui_wrong module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.image_stats">cocpit.image_stats module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.model_config">cocpit.model_config module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.models">cocpit.models module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.performance_metrics">cocpit.performance_metrics module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.predictions">cocpit.predictions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.process_sheets">cocpit.process_sheets module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.run_model">cocpit.run_model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.runner">cocpit.runner module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.timing">cocpit.timing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.train">cocpit.train module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit.validate">cocpit.validate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-cocpit">Module contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modules">modules:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">COCPIT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">data</a> &raquo;</li>
      <li>cocpit package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cocpit.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="cocpit-package">
<h1>cocpit package<a class="headerlink" href="#cocpit-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-cocpit.add_date">
<span id="cocpit-add-date-module"></span><h2>cocpit.add_date module<a class="headerlink" href="#module-cocpit.add_date" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.add_date.Date">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.add_date.</span></span><span class="sig-name descname"><span class="pre">Date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.add_date.Date" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Add date to dataframe from filename</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – A dataframe holding image filenames</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.add_date.Date.date_column">
<span class="sig-name descname"><span class="pre">date_column</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.add_date.Date.date_column" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Create a date column from filename column</p></li>
<li><p>Note that the date format may need to change for each campaign</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.add_date.Date.convert_date_format">
<span class="sig-name descname"><span class="pre">convert_date_format</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.add_date.Date.convert_date_format" title="Permalink to this definition"></a></dt>
<dd><p>Convert date column to datetime format</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.add_date.Date.move_to_front">
<span class="sig-name descname"><span class="pre">move_to_front</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.add_date.Date.move_to_front" title="Permalink to this definition"></a></dt>
<dd><p>Move the date to head of list using index, pop and insert</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.auto_str">
<span id="cocpit-auto-str-module"></span><h2>cocpit.auto_str module<a class="headerlink" href="#module-cocpit.auto_str" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="cocpit.auto_str.auto_str">
<span class="sig-prename descclassname"><span class="pre">cocpit.auto_str.</span></span><span class="sig-name descname"><span class="pre">auto_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.auto_str.auto_str" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Automatically implements a string representation for classes
instead of memory id</p></li>
<li><p>Finds all attributes of the class and prints them in a readable format</p></li>
<li><p>Called with str(object) or str(instance) after using &#64;auto_str decorator
above class name</p></li>
</ul>
</dd></dl>

</section>
<section id="module-cocpit.data_loaders">
<span id="cocpit-data-loaders-module"></span><h2>cocpit.data_loaders module<a class="headerlink" href="#module-cocpit.data_loaders" title="Permalink to this headline"></a></h2>
<p>Retrives data loaders from Pytorch</p>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.data_loaders.ImageFolderWithPaths">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.data_loaders.</span></span><span class="sig-name descname"><span class="pre">ImageFolderWithPaths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_transform=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader=&lt;function</span> <span class="pre">default_loader&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_valid_file=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.data_loaders.ImageFolderWithPaths" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torchvision.datasets.folder.ImageFolder</span></code></p>
<ul class="simple">
<li><p>Custom dataset that includes image file paths.</p></li>
<li><p>Used in get_data in this module</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>str</em>) – data directory</p></li>
<li><p><strong>transform</strong> (<em>transforms.Compose</em>) – transformations based on train, val, or test</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cocpit.data_loaders.TestDataSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.data_loaders.</span></span><span class="sig-name descname"><span class="pre">TestDataSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">open_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.data_loaders.TestDataSet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.dataset.Dataset</span></code></p>
<ul class="simple">
<li><p>Create dataloader for new or unseen testing data</p></li>
<li><p>Used in notenooks/check_classifications.ipynb for example instantiation</p></li>
<li><p>Applies transformations such as resizing and normalization</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>open_dir</strong> (<em>str</em>) – directory holding the data to open</p></li>
<li><p><strong>file_list</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list of filenames</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.data_loaders.get_data">
<span class="sig-prename descclassname"><span class="pre">cocpit.data_loaders.</span></span><span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.data_loaders.get_data" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Use the Pytorch ImageFolder class to read in training data</p></li>
<li><p>Training data needs to be organized all in one folder with subfolders for each class</p></li>
<li><p>Applies transforms and data augmentation</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>phase</strong> (<em>str</em>) – ‘train’ or ‘val’</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(image, label, path)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>data (tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.data_loaders.balanced_sampler">
<span class="sig-prename descclassname"><span class="pre">cocpit.data_loaders.</span></span><span class="sig-name descname"><span class="pre">balanced_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.data_loaders.balanced_sampler" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Creates weights for each class for use in the dataloader sampler argument</p></li>
<li><p>Lower count classes are sampled more frequently and higher count classes are sampled less frequently</p></li>
<li><p>Only used in the training dataloader</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>train_labels</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – numerically labeled classes for training dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of samples per class
train_samples_weights (torch.DoubleTensor): weights for each class for sampling</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class_sample_counts (List)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.data_loaders.create_loader">
<span class="sig-prename descclassname"><span class="pre">cocpit.data_loaders.</span></span><span class="sig-name descname"><span class="pre">create_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pin_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.data_loaders.create_loader" title="Permalink to this definition"></a></dt>
<dd><p>Make an iterable of batches across a dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.utils.data.Subset</em>) – the dataset to load</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – number of images to be read into memory at a time</p></li>
<li><p><strong>sampler</strong> (<em>torch.utils.data.Sampler</em>) – the method used to iterate over indices of dataset (e.g., random shuffle)</p></li>
<li><p><strong>pin_memory</strong> (<em>bool</em>) – For data loading, passing pin_memory=True to a DataLoader will automatically
put the fetched data Tensors in pinned memory, and thus enables faster data
transfer to CUDA-enabled GPUs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dataset to be iterated over using sampling strategy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.utils.data.DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.data_loaders.save_valloader">
<span class="sig-prename descclassname"><span class="pre">cocpit.data_loaders.</span></span><span class="sig-name descname"><span class="pre">save_valloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.data_loaders.save_valloader" title="Permalink to this definition"></a></dt>
<dd><p>Save validation dataloader based on paths in config.py</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val_data</strong> (<em>torch.utils.data.Subset</em>) – the validation dataset</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cocpit.geometry">
<span id="cocpit-geometry-module"></span><h2>cocpit.geometry module<a class="headerlink" href="#module-cocpit.geometry" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.geometry.Geometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.geometry.</span></span><span class="sig-name descname"><span class="pre">Geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">open_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry.Geometry" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cocpit.image.Image</span></code></p>
<p>Calculates geometric attributes of a particle in an image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<em>float</em>) – aspect ratio from rectangle</p></li>
<li><p><strong>extreme_points</strong> (<em>float</em>) – computes how separated the outer most points are on the largest contour. Higher std. deviation = more spread out</p></li>
<li><p><strong>area</strong> (<em>float</em>) – area of largest contour</p></li>
<li><p><strong>perim</strong> (<em>float</em>) – perimeter of largest contour</p></li>
<li><p><strong>complexity</strong> (<em>float</em>) – how intricate &amp; complicated the particle is</p></li>
<li><p><strong>hull</strong> (<em>np.ndarray</em>) – a convex hull around the largest contour</p></li>
<li><p><strong>convex_perim</strong> (<em>float</em>) – perimeter of the convex hull of the largest contour</p></li>
<li><p><strong>hull_area</strong> (<em>float</em>) – area of a convex hull surrounding the largest contour</p></li>
<li><p><strong>filled_circular_area_ratio</strong> (<em>float</em>) – area of the largest contour divided by the area of
an encompassing circle - useful for spheres that have reflection
spots that are not captured by the largest contour and leave a horseshoe pattern</p></li>
<li><p><strong>laplacian</strong> (<em>float</em>) – Computes the variance (i.e. standard deviation squared)
of a convolved 3 x 3 kernel.  The Laplacian highlights regions
of an image containing rapid intensity changes. If the variance falls
below a pre-defined threshold, then the image is considered blurry;
otherwise, the image is not blurry.</p></li>
<li><p><strong>circularity</strong> (<em>float</em>) – 4*pi*area/perimeter**2</p></li>
<li><p><strong>roundness</strong> (<em>float</em>) – similar to circularity but divided by the perimeter
that surrounds the largest contour squared instead of the
actual convoluted perimeter</p></li>
<li><p><strong>perim_area_ratio</strong> (<em>float</em>) – perimeter/area</p></li>
<li><p><strong>solidity</strong> (<em>float</em>) – area/hull_area</p></li>
<li><p><strong>equiv_d</strong> (<em>float</em>) – equivalent diameter of a circle with the same area as the largest contour</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.geometry.Geometry.calc_phi">
<span class="sig-name descname"><span class="pre">calc_phi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry.Geometry.calc_phi" title="Permalink to this definition"></a></dt>
<dd><p>Calculate aspect ratio from rectangle</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.geometry.Geometry.create_ellipse">
<span class="sig-name descname"><span class="pre">create_ellipse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry.Geometry.create_ellipse" title="Permalink to this definition"></a></dt>
<dd><p>Fit ellipse to particle</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Aspect ratio [0-1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.geometry.Geometry.calc_extreme_points">
<span class="sig-name descname"><span class="pre">calc_extreme_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry.Geometry.calc_extreme_points" title="Permalink to this definition"></a></dt>
<dd><p>Computes how separated the outer most points are on the largest contour.
Higher std. deviation = more spread out</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.geometry.Geometry.calc_filled_circular_area_ratio">
<span class="sig-name descname"><span class="pre">calc_filled_circular_area_ratio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry.Geometry.calc_filled_circular_area_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Returns the area of the largest contour divided by the area of
an encompassing circle - useful for spheres that have reflection
spots that are not captured by the largest contour and leave a horseshoe pattern</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.geometry.Geometry.calc_complexity">
<span class="sig-name descname"><span class="pre">calc_complexity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry.Geometry.calc_complexity" title="Permalink to this definition"></a></dt>
<dd><p>How intricate &amp; complicated the particle is</p>
<dl class="simple">
<dt>see:</dt><dd><p>Schmitt, C. G., and A. J. Heymsfield (2014),
Observational quantification of the separation of
simple and complex atmospheric ice particles,
Geophys. Res. Lett., 41, 1301–1307, doi:10.1002/ 2013GL058781.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="cocpit-geometry-runner-module">
<h2>cocpit.geometry_runner module<a class="headerlink" href="#cocpit-geometry-runner-module" title="Permalink to this headline"></a></h2>
<span class="target" id="module-cocpit.geometry_runner"></span><dl class="py function">
<dt class="sig sig-object py" id="cocpit.geometry_runner.keys">
<span class="sig-prename descclassname"><span class="pre">cocpit.geometry_runner.</span></span><span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry_runner.keys" title="Permalink to this definition"></a></dt>
<dd><p>Particle attribute names</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>attribute names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.geometry_runner.properties_null">
<span class="sig-prename descclassname"><span class="pre">cocpit.geometry_runner.</span></span><span class="sig-name descname"><span class="pre">properties_null</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry_runner.properties_null" title="Permalink to this definition"></a></dt>
<dd><p>Set particle attributes to a null value
if the image area = 0</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of -999 with a length of attributes</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.geometry_runner.properties">
<span class="sig-prename descclassname"><span class="pre">cocpit.geometry_runner.</span></span><span class="sig-name descname"><span class="pre">properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry_runner.properties" title="Permalink to this definition"></a></dt>
<dd><p>Calculated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image</strong> (<em>geometry.Image</em>) – Loaded PIL image</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of calculated particle properties</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.geometry_runner.get_attributes">
<span class="sig-prename descclassname"><span class="pre">cocpit.geometry_runner.</span></span><span class="sig-name descname"><span class="pre">get_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">open_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry_runner.get_attributes" title="Permalink to this definition"></a></dt>
<dd><p>Create df of particle geometric properties</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename of the image to load</p></li>
<li><p><strong>open_dir</strong> (<em>str</em>) – directory to open the image in</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.geometry_runner.main">
<span class="sig-prename descclassname"><span class="pre">cocpit.geometry_runner.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">open_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.geometry_runner.main" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Reads in dataframe for a campaign after ice classification</p></li>
<li><p>Calculates particle geometric properties</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – dataframe with image filenames</p></li>
<li><p><strong>open_dir</strong> (<em>str</em>) – directory to the images</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe with image attributes appended</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>df (pd.DataFrame)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cocpit.fold_setup">
<span id="cocpit-fold-setup-module"></span><h2>cocpit.fold_setup module<a class="headerlink" href="#module-cocpit.fold_setup" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.fold_setup.</span></span><span class="sig-name descname"><span class="pre">FoldSetup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<ul class="simple">
<li><p>Setup training and validation indices for labels and data based on k-fold cross validation</p></li>
<li><p>Called in __main__.py</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>str</em>) – name of model architecture</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – number of images read into memory at a time</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – number of iterations on dataset</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup.print_composition">
<span class="sig-name descname"><span class="pre">print_composition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup.print_composition" title="Permalink to this definition"></a></dt>
<dd><p>Prints length of train and test data based on validation %
defined in config.py</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup.split_data">
<span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">composition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup.split_data" title="Permalink to this definition"></a></dt>
<dd><p>Create a subset of data and labels for training
and validation based on indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>composition</strong> (<em>bool</em>) – whether to print the class totals for each dataset</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup.update_save_names">
<span class="sig-name descname"><span class="pre">update_save_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup.update_save_names" title="Permalink to this definition"></a></dt>
<dd><p>Update config save names for model and validation dataloader
so that each fold gets saved</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup.train_loader">
<span class="sig-name descname"><span class="pre">train_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">balance_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup.train_loader" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Create train loader that iterates images in batches</p></li>
<li><p>Balance the distribution of sampled images given imbalance</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>balance_weights</strong> (<em>bool</em>) – pull from training dataset evenly among classes</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an iterable dataloader for training</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.utils.data.DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup.val_loader">
<span class="sig-name descname"><span class="pre">val_loader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup.val_loader" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Create validation loader to be iterated in batches</p></li>
<li><p>Option to use the entire labeled dataset if config.VALID_SIZE small</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup.create_dataloaders">
<span class="sig-name descname"><span class="pre">create_dataloaders</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup.create_dataloaders" title="Permalink to this definition"></a></dt>
<dd><p>Create dict of train/val dataloaders based on split and sampler from StratifiedKFold</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup.nofold_indices">
<span class="sig-name descname"><span class="pre">nofold_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup.nofold_indices" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>If not applying cross-fold validation, split training dataset</p></li>
</ul>
<p>based on config.VALID_SIZE
- Shuffle first and then split dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.fold_setup.FoldSetup.kfold_training">
<span class="sig-name descname"><span class="pre">kfold_training</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.fold_setup.FoldSetup.kfold_training" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Split dataset into folds</p></li>
<li><p>Preserve the percentage of samples for each class with stratified</p></li>
<li><p>Create dataloaders for each fold</p></li>
<li><p>Train and validate the model on each fold</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.gui">
<span id="cocpit-gui-module"></span><h2>cocpit.gui module<a class="headerlink" href="#module-cocpit.gui" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.gui.GUI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.gui.</span></span><span class="sig-name descname"><span class="pre">GUI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_paths</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui.GUI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates buttons in notebooks/gui_check_dataset_one_class.ipynb to label images</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_labels</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – List of labels on training data from one specified class</p></li>
<li><p><strong>all_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – List of paths of labeleld data from one specified class</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui.GUI.open_image">
<span class="sig-name descname"><span class="pre">open_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui.GUI.open_image" title="Permalink to this definition"></a></dt>
<dd><p>Open an image from a path at a given index</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>opened PIL image or None if no image is opened</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Union[Image.Image, None]</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>FileNotFoundError</strong> – File already moved and cannot be opened</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui.GUI.make_buttons">
<span class="sig-name descname"><span class="pre">make_buttons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui.GUI.make_buttons" title="Permalink to this definition"></a></dt>
<dd><p>Use ipywidgets to create a box for the image, bar chart, dropdown,
and next button</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui.GUI.on_button_next">
<span class="sig-name descname"><span class="pre">on_button_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui.GUI.on_button_next" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>When the next button is clicked, make a new image and bar chart appear by updating the index within the wrong predictions by 1</p></li>
<li><p>b is the button instance but not actually passed.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui.GUI.view_classifications">
<span class="sig-name descname"><span class="pre">view_classifications</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui.GUI.view_classifications" title="Permalink to this definition"></a></dt>
<dd><p>Show image</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui.GUI.save_image">
<span class="sig-name descname"><span class="pre">save_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">change</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui.GUI.save_image" title="Permalink to this definition"></a></dt>
<dd><p>Move the image based on dropdown selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>change</strong> (<em>traitlets.utils.bunch.Bunch</em>) – dropdown selection</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.gui_label">
<span id="cocpit-gui-label-module"></span><h2>cocpit.gui_label module<a class="headerlink" href="#module-cocpit.gui_label" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.gui_label.GUI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.gui_label.</span></span><span class="sig-name descname"><span class="pre">GUI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_label.GUI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>View and label images in notebooks/label.ipynb</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – paths to images</p></li>
<li><p><strong>folder_dest</strong> (<em>str</em>) – where to save images to</p></li>
<li><p><strong>precip</strong> (<em>pd.core.series.Series</em>) – corresponding precipitation measurements to images</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_label.GUI.open_image">
<span class="sig-name descname"><span class="pre">open_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_label.GUI.open_image" title="Permalink to this definition"></a></dt>
<dd><p>Open an image from a path at a given index</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>opened PIL image or None if no image is opened</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Union[Image.Image, None]</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>FileNotFoundError</strong> – File already moved and cannot be opened</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_label.GUI.make_buttons">
<span class="sig-name descname"><span class="pre">make_buttons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_label.GUI.make_buttons" title="Permalink to this definition"></a></dt>
<dd><p>Make buttons for each class and an undo button</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_label.GUI.align_buttons">
<span class="sig-name descname"><span class="pre">align_buttons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_label.GUI.align_buttons" title="Permalink to this definition"></a></dt>
<dd><p>Alter layout based on number of classes</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_label.GUI.cp_to_dir">
<span class="sig-name descname"><span class="pre">cp_to_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_label.GUI.cp_to_dir" title="Permalink to this definition"></a></dt>
<dd><p>Copy from original dir to new directory based on selected class label</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_label.GUI.undo">
<span class="sig-name descname"><span class="pre">undo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_label.GUI.undo" title="Permalink to this definition"></a></dt>
<dd><p>Undo moving image into folder</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>FileNotFoundError</strong> – file already moved or not found</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_label.GUI.display_image">
<span class="sig-name descname"><span class="pre">display_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_label.GUI.display_image" title="Permalink to this definition"></a></dt>
<dd><p>Show image</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.gui_wrong">
<span id="cocpit-gui-wrong-module"></span><h2>cocpit.gui_wrong module<a class="headerlink" href="#module-cocpit.gui_wrong" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.gui_wrong.</span></span><span class="sig-name descname"><span class="pre">GUI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrong_trunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_topk_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_topk_classes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<ul class="simple">
<li><p>ipywidget buttons to label incorrect predictions from a dataloader.</p></li>
<li><p>The dataloader, model, and all class variables are initialized in notebooks/move_wrong_predictions.ipynb</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrong_trunc</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – indices where the model predictions are wrong</p></li>
<li><p><strong>all_labels</strong> (<em>np.ndarray</em><em>[</em><em>int</em><em>]</em>) – image labels</p></li>
<li><p><strong>all_paths</strong> (<em>np.ndarray</em><em>[</em><em>str</em><em>]</em>) – image paths</p></li>
<li><p><strong>all_topk_props</strong> (<em>np.ndarray</em><em>[</em><em>float</em><em>]</em>) – top predicted probabilites</p></li>
<li><p><strong>all_topk_classes</strong> (<em>np.ndarray</em><em>[</em><em>int</em><em>]</em>) – classes related to the top predicted probabilites</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.open_image">
<span class="sig-name descname"><span class="pre">open_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.open_image" title="Permalink to this definition"></a></dt>
<dd><p>Open an image from a path at a given index</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>opened PIL image or None if no image is opened</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Union[Image.Image, None]</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>FileNotFoundError</strong> – File already moved and cannot be opened</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.make_buttons">
<span class="sig-name descname"><span class="pre">make_buttons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.make_buttons" title="Permalink to this definition"></a></dt>
<dd><p>Make buttons for each category</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.on_button_next">
<span class="sig-name descname"><span class="pre">on_button_next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.on_button_next" title="Permalink to this definition"></a></dt>
<dd><p>When the next button is clicked, make a new image and bar chart appear
by updating the index within the wrong predictions by 1</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.align_buttons">
<span class="sig-name descname"><span class="pre">align_buttons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.align_buttons" title="Permalink to this definition"></a></dt>
<dd><p>Alter layout based on # of classes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.init_fig">
<span class="sig-name descname"><span class="pre">init_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.init_fig" title="Permalink to this definition"></a></dt>
<dd><p>Display the raw image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Image.Image</em>) – opened image</p></li>
<li><p><strong>ax1</strong> (<em>plt.Axes</em>) – subplot axis</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.bar_chart">
<span class="sig-name descname"><span class="pre">bar_chart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.bar_chart" title="Permalink to this definition"></a></dt>
<dd><p>Create barchart that outputs top k predictions for a given image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ax2</strong> (<em>plt.Axes</em>) – subplot axis</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.plot_saliency">
<span class="sig-name descname"><span class="pre">plot_saliency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">224</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.plot_saliency" title="Permalink to this definition"></a></dt>
<dd><p>Create saliency map for image in test dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>PIL.Image.Image</em>) – opened image</p></li>
<li><p><strong>ax2</strong> (<em>plt.Axes</em>) – subplot axis</p></li>
<li><p><strong>size</strong> (<em>int</em>) – image size for transformation</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.save_image">
<span class="sig-name descname"><span class="pre">save_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.save_image" title="Permalink to this definition"></a></dt>
<dd><p>Move the image based on dropdown selection</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.gui_wrong.GUI.visualizations">
<span class="sig-name descname"><span class="pre">visualizations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.gui_wrong.GUI.visualizations" title="Permalink to this definition"></a></dt>
<dd><p>Use the human and model labels and classes to
create a bar chart with the top k predictions
from the image at the current index</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.image_stats">
<span id="cocpit-image-stats-module"></span><h2>cocpit.image_stats module<a class="headerlink" href="#module-cocpit.image_stats" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="cocpit.image_stats.main">
<span class="sig-prename descclassname"><span class="pre">cocpit.image_stats.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.image_stats.main" title="Permalink to this definition"></a></dt>
<dd><p>Print the #/% of cutoff particles after removing blurry, fragmented, and spherical drops</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cutoff</strong> (<em>float</em>) – Percent of particle that can intersect the border</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cocpit.model_config">
<span id="cocpit-model-config-module"></span><h2>cocpit.model_config module<a class="headerlink" href="#module-cocpit.model_config" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.model_config.ModelConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.model_config.</span></span><span class="sig-name descname"><span class="pre">ModelConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.model_config.ModelConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Model configurations for:</dt><dd><ul class="simple">
<li><p>dropout</p></li>
<li><p>optimizer</p></li>
<li><p>device settings (cpu/gpu)</p></li>
<li><p>parameters to update</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torchvision.models</em>) – loaded pytorch model object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.model_config.ModelConfig.update_params">
<span class="sig-name descname"><span class="pre">update_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_extract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.model_config.ModelConfig.update_params" title="Permalink to this definition"></a></dt>
<dd><p>When feature extracting, we only want to update the parameters
of the last layer, or in other words, we only want to update the
parameters for the layer(s) we are reshaping. Therefore, we do
not need to compute the gradients of the parameters that we are
not changing, so for efficiency we set the .requires_grad attribute
to False. This is important because by default, this attribute is
set to True. Then, when we initialize the new layer and by default
the new parameters have .requires_grad=True so only the new layer’s
parameters will be updated. When we are finetuning we can leave all
of the .required_grad’s set to the default of True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>feature_extract</strong> (<em>bool</em>) – only update the weights of the last layer</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>params_to_update (generator)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.model_config.ModelConfig.count_parameters">
<span class="sig-name descname"><span class="pre">count_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.model_config.ModelConfig.count_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Number of model parameters to update</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.model_config.ModelConfig.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.model_config.ModelConfig.optimizer" title="Permalink to this definition"></a></dt>
<dd><p>Model optimizer for stochastic gradient decent</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SGD</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.model_config.ModelConfig.set_dropout">
<span class="sig-name descname"><span class="pre">set_dropout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.model_config.ModelConfig.set_dropout" title="Permalink to this definition"></a></dt>
<dd><p>Apply dropout rate: a technique to fight overfitting and improve neural network generalization</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.model_config.ModelConfig.to_device">
<span class="sig-name descname"><span class="pre">to_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.model_config.ModelConfig.to_device" title="Permalink to this definition"></a></dt>
<dd><p>Push model to gpu(s) if available</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.model_config.main">
<span class="sig-prename descclassname"><span class="pre">cocpit.model_config.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.model_config.main" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">SGD</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">DataParallel</span></code>]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cocpit.models">
<span id="cocpit-models-module"></span><h2>cocpit.models module<a class="headerlink" href="#module-cocpit.models" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.models.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.models.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_extract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Model initializations from torchvision. We always train from scratch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_extract</strong> (<em>bool</em>) – update only the last layer parameters. Default False</p></li>
<li><p><strong>use_pretrained</strong> (<em>bool</em>) – use a pre-trained model to extract meaningful features from new samples. Default False.</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – number of classes</p></li>
<li><p><strong>model</strong> (<em>torchvision.models</em>) – a torchvision.models instance</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.set_parameter_requires_grad">
<span class="sig-name descname"><span class="pre">set_parameter_requires_grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.set_parameter_requires_grad" title="Permalink to this definition"></a></dt>
<dd><p>Finetune the whole model when feature_extract is True, else only update the reshaped layer params</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.resnet_classifier">
<span class="sig-name descname"><span class="pre">resnet_classifier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.resnet_classifier" title="Permalink to this definition"></a></dt>
<dd><p>create linear output layer equal to number of classes</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.vgg_classifier">
<span class="sig-name descname"><span class="pre">vgg_classifier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.vgg_classifier" title="Permalink to this definition"></a></dt>
<dd><p>create linear output layer equal to number of classes</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.densenet_classifier">
<span class="sig-name descname"><span class="pre">densenet_classifier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.densenet_classifier" title="Permalink to this definition"></a></dt>
<dd><p>create linear output layer equal to number of classes</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.resnet18">
<span class="sig-name descname"><span class="pre">resnet18</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.resnet18" title="Permalink to this definition"></a></dt>
<dd><p>resnet 18 architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.resnet34">
<span class="sig-name descname"><span class="pre">resnet34</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.resnet34" title="Permalink to this definition"></a></dt>
<dd><p>resnet 34 architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.resnet152">
<span class="sig-name descname"><span class="pre">resnet152</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.resnet152" title="Permalink to this definition"></a></dt>
<dd><p>resnet 152 architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.alexnet">
<span class="sig-name descname"><span class="pre">alexnet</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.alexnet" title="Permalink to this definition"></a></dt>
<dd><p>alexnet architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.vgg16">
<span class="sig-name descname"><span class="pre">vgg16</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.vgg16" title="Permalink to this definition"></a></dt>
<dd><p>VGG 16 architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.vgg19">
<span class="sig-name descname"><span class="pre">vgg19</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.vgg19" title="Permalink to this definition"></a></dt>
<dd><p>VGG 19 architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.densenet169">
<span class="sig-name descname"><span class="pre">densenet169</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.densenet169" title="Permalink to this definition"></a></dt>
<dd><p>Densenet 169 architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.densenet201">
<span class="sig-name descname"><span class="pre">densenet201</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.densenet201" title="Permalink to this definition"></a></dt>
<dd><p>Densenet 201 architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.models.Model.efficient">
<span class="sig-name descname"><span class="pre">efficient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.Model.efficient" title="Permalink to this definition"></a></dt>
<dd><p>EfficientNet-b0 architecture</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.models.initialize_model">
<span class="sig-prename descclassname"><span class="pre">cocpit.models.</span></span><span class="sig-name descname"><span class="pre">initialize_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_extract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.models.initialize_model" title="Permalink to this definition"></a></dt>
<dd><p>Set up model architectures. All input size of 224</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_extract</strong> (<em>bool</em>) – Start with a pretrained model and only
update the final layer weights from which we derive predictions</p></li>
<li><p><strong>use_pretrained</strong> (<em>bool</em>) – Update all of the model’s parameters (retrain). Default = False</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>&lt;module ‘torchvision.models’ from ‘/usr/local/lib/python3.10/site-packages/torchvision/models/__init__.py’&gt;</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cocpit.performance_metrics">
<span id="cocpit-performance-metrics-module"></span><h2>cocpit.performance_metrics module<a class="headerlink" href="#module-cocpit.performance_metrics" title="Permalink to this headline"></a></h2>
<p>Holds epoch and batch metrics for both the training and validation datasets
Logs metrics to console and/or comet-ml interface (see config.py to turn on)</p>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.performance_metrics.Metrics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.performance_metrics.</span></span><span class="sig-name descname"><span class="pre">Metrics</span></span><a class="headerlink" href="#cocpit.performance_metrics.Metrics" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Calculate batch and epoch metrics for training and validation datasets
Inherited in train and validate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloaders</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>torch.utils.data.DataLoader</em><em>]</em>) – training and validation dict that loads images with sampling procedure</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.sgd.SGD</em>) – an algorithm that modifies the attributes of the neural network</p></li>
<li><p><strong>model</strong> (<em>torch.nn.parallel.data_parallel.DataParallel</em>) – saved and loaded model</p></li>
<li><p><strong>model_name</strong> (<em>str</em>) – name of model architecture</p></li>
<li><p><strong>epoch</strong> (<em>int</em>) – epoch index in training loop</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – max epochs</p></li>
<li><p><strong>kfold</strong> (<em>int</em>) – number of k-folds used in resampling procedure</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – number of images read into memory at a time</p></li>
<li><p><strong>totals</strong> – (float): number of images seen</p></li>
<li><p><strong>running_loss</strong> – (float): cumulative penalties for bad predictions</p></li>
<li><p><strong>running_corrects</strong> – (torch.Tensor): cumulative accuracy over batches</p></li>
<li><p><strong>epoch_loss</strong> – (float): loss at the end of an epoch</p></li>
<li><p><strong>epoch_acc</strong> – (float): accuracy at the end of an epoch</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.performance_metrics.Metrics.batch_metrics">
<span class="sig-name descname"><span class="pre">batch_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.performance_metrics.Metrics.batch_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Calculate loss and accuracy for each batch in dataloader</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.performance_metrics.Metrics.epoch_metrics">
<span class="sig-name descname"><span class="pre">epoch_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.performance_metrics.Metrics.epoch_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Calculate loss and accuracy after each epoch (iteration across all batches)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.performance_metrics.Metrics.log_epoch_metrics">
<span class="sig-name descname"><span class="pre">log_epoch_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acc_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.performance_metrics.Metrics.log_epoch_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Log epoch metrics to comet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acc_name</strong> (<em>str</em>) – name to log for accuracy (e.g., “epoch_acc_val”)</p></li>
<li><p><strong>loss_name</strong> (<em>str</em>) – name to log for loss (e.g., “epoch_loss_val”)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.performance_metrics.Metrics.print_batch_metrics">
<span class="sig-name descname"><span class="pre">print_batch_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.performance_metrics.Metrics.print_batch_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Outputs batch iteration, loss, and accuracy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>phase</strong> (<em>str</em>) – “Train” or “Validation”</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.performance_metrics.Metrics.print_epoch_metrics">
<span class="sig-name descname"><span class="pre">print_epoch_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.performance_metrics.Metrics.print_epoch_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Print epoch loss and accuracy based on phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>phase</strong> (<em>str</em>) – “train” or “val”</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.performance_metrics.Metrics.write_output">
<span class="sig-name descname"><span class="pre">write_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.performance_metrics.Metrics.write_output" title="Permalink to this definition"></a></dt>
<dd><p>Write acc and loss to csv file within model, epoch, kfold iteration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – config.ACC_SAVENAME_TRAIN or config.ACC_SAVENAME_VAL depending on phase</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.predictions">
<span id="cocpit-predictions-module"></span><h2>cocpit.predictions module<a class="headerlink" href="#module-cocpit.predictions" title="Permalink to this headline"></a></h2>
<p>Predict on a batch of images.
Find incorrect predictions from validation dataloader.
To be used with gui.py in notebooks/gui_move_wrong_predictions.ipynb</p>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.predictions.BatchPredictions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.predictions.</span></span><span class="sig-name descname"><span class="pre">BatchPredictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.BatchPredictions" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Makes predictions on a given batch of data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>torch.Tensor</em>) – loaded imgs on device</p></li>
<li><p><strong>model</strong> (<em>torch.nn.parallel.data_parallel.DataParallel</em>) – model on device for prediction</p></li>
<li><p><strong>max_preds</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – class with the highest probability across all images in the batch</p></li>
<li><p><strong>probs</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>]</em>) – list of top k probabilities across all images in the batch</p></li>
<li><p><strong>classes</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>]</em>) – list of top k classes across all images in the batch</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.BatchPredictions.find_logits">
<span class="sig-name descname"><span class="pre">find_logits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.BatchPredictions.find_logits" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Vector of raw (non-normalized) predictions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.BatchPredictions.find_max_preds">
<span class="sig-name descname"><span class="pre">find_max_preds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.BatchPredictions.find_max_preds" title="Permalink to this definition"></a></dt>
<dd><p>Finds the class with the highest probability across all images in the batch</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.BatchPredictions.preds_softmax">
<span class="sig-name descname"><span class="pre">preds_softmax</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.BatchPredictions.preds_softmax" title="Permalink to this definition"></a></dt>
<dd><p>Applies a softmax function such that probabilities lie in the range [0, 1] and sum to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>normalized probabilities</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.BatchPredictions.top_k_preds">
<span class="sig-name descname"><span class="pre">top_k_preds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_k_preds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.BatchPredictions.top_k_preds" title="Permalink to this definition"></a></dt>
<dd><p>Get top k probabilities and respective classes for each index in the batch for bar chart</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>top_k_preds</strong> (<em>int</em>) – the top k probabilities/classes predicted</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.predictions.</span></span><span class="sig-name descname"><span class="pre">LoaderPredictions</span></span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>In gui.py, use a model and validation dataloader to check predictions.
Loops through all validation loader predictions but only saves incorrect predictions.
The incorrect predictions are loaded into a gui so that a user can decide
whether the label is wrong upon second look (i.e., the model is right).
The image is automatically moved upon choosing a class from the dropdown menu.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self.all_labels</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – list of labels across all batches</p></li>
<li><p><strong>self.all_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list of paths across all batches</p></li>
<li><p><strong>self.all_topk_probs</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – list of topk probabilities across all batches</p></li>
<li><p><strong>self.all_topk_classes</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – list of topk classes across all batches</p></li>
<li><p><strong>self.all_max_preds</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – list of max predictions across all batches</p></li>
<li><p><strong>self.wrong_trunc</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – indices of wrong predictions</p></li>
<li><p><strong>self.wrong_idx</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – all indices where the model incorrectly predicted</p></li>
<li><p><strong>self.labels</strong> (<em>bool</em>) – True if labels are provided (i.e., validation not test)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fold</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions.load_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions.load_val_loader">
<span class="sig-name descname"><span class="pre">load_val_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fold</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions.load_val_loader" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions.concat">
<span class="sig-name descname"><span class="pre">concat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions.concat" title="Permalink to this definition"></a></dt>
<dd><p>Flatten a variable across batches</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions.concatenate_loader_vars">
<span class="sig-name descname"><span class="pre">concatenate_loader_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions.concatenate_loader_vars" title="Permalink to this definition"></a></dt>
<dd><p>Flatten arrays from appending in batches</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions.find_wrong_indices">
<span class="sig-name descname"><span class="pre">find_wrong_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions.find_wrong_indices" title="Permalink to this definition"></a></dt>
<dd><p>Find all indices where the model incorrectly predicted</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_k_preds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions.predict" title="Permalink to this definition"></a></dt>
<dd><p>Make predictions across all possible validation datasets (including k-folds)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top_k_preds</strong> (<em>int</em>) – the top k classes will be displayed in bar chart</p></li>
<li><p><strong>folds</strong> (<em>int</em>) – number of k-folds used in resampling procedure
if kfold cross validation was not used, keep as 1</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions.predict_test_loader">
<span class="sig-name descname"><span class="pre">predict_test_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k_preds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions.predict_test_loader" title="Permalink to this definition"></a></dt>
<dd><p>Predict on test data loader</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_loader</strong> (<em>torch.utils.data.dataloader.DataLoader</em>) – dataloader holding test set</p></li>
<li><p><strong>top_k_preds</strong> (<em>int</em>) – the top k predictions will be displayed in bar chart
must be &lt; number of classes</p></li>
<li><p><strong>fold</strong> (<em>int</em>) – number of k-folds used in resampling procedure
if kfold cross validation was not used, keep as 0</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.predictions.LoaderPredictions.hone_incorrect_predictions">
<span class="sig-name descname"><span class="pre">hone_incorrect_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">human_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.predictions.LoaderPredictions.hone_incorrect_predictions" title="Permalink to this definition"></a></dt>
<dd><p>Find indices where human labeled as one thing and model labeled as another</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_list</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – dictionary of class labels mapped to integers</p></li>
<li><p><strong>human_label</strong> (<em>int</em>) – category of the human label</p></li>
<li><p><strong>model_label</strong> (<em>int</em>) – category of the model label</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.process_sheets">
<span id="cocpit-process-sheets-module"></span><h2>cocpit.process_sheets module<a class="headerlink" href="#module-cocpit.process_sheets" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.process_sheets.</span></span><span class="sig-name descname"><span class="pre">Image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">open_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reads, extracts, and performs morphological processing on png sheets of CPI images</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>open_dir</strong> (<em>str</em>) – the path where the files are located</p></li>
<li><p><strong>file</strong> (<em>str</em>) – file [including path] to sheet with cpi images</p></li>
<li><p><strong>save_dir</strong> (<em>str</em>) – the path where the files are saved</p></li>
<li><p><strong>self.files</strong> (<em>str</em>) – list of files to be processed</p></li>
<li><p><strong>self.widths</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – width of rectangular roi frame</p></li>
<li><p><strong>self.heights</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – height of rectangular roi frame</p></li>
<li><p><strong>self.particle_heights</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – particle heights</p></li>
<li><p><strong>self.particle_widths</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – particle widths</p></li>
<li><p><strong>self.cutoffs</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – percent of particle intersecting border</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.read_image">
<span class="sig-name descname"><span class="pre">read_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_original</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.read_image" title="Permalink to this definition"></a></dt>
<dd><p>Reads sheet into memory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>show_original</strong> (<em>bool</em>) – whether to show the original sheet in an opencv window</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.dilate">
<span class="sig-name descname"><span class="pre">dilate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_dilate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.dilate" title="Permalink to this definition"></a></dt>
<dd><p>Increases the object area and useful in joining broken parts of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.find_sheet_contours">
<span class="sig-name descname"><span class="pre">find_sheet_contours</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.find_sheet_contours" title="Permalink to this definition"></a></dt>
<dd><p>Find all contours on sheet and convert to b/w</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>contours from cv2.findContours</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>cnts (List[int])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.remove_text">
<span class="sig-name descname"><span class="pre">remove_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cnts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.remove_text" title="Permalink to this definition"></a></dt>
<dd><p>Removes text such as date/time stamp by drawing over small contours in white.
If the text is on the particle itself and connected to the largest contour, it stays
Should a very small particle be &lt; 200 px^2, it is also masked</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cnts</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – list of contours</p></li>
<li><p><strong>small_thresh</strong> (<em>float</em>) – mask areas in px smaller than this threshold</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.largest_contour">
<span class="sig-name descname"><span class="pre">largest_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cnts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.largest_contour" title="Permalink to this definition"></a></dt>
<dd><p>Find largest contour out of list of contours on image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cnts</strong> (<em>list</em>) – list of contours</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.particle_dimensions">
<span class="sig-name descname"><span class="pre">particle_dimensions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.particle_dimensions" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the length and width of particles in microns
from a rectangular bounding box
CPI probe: 1 px = 2.3 microns</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.cutoff" title="Permalink to this definition"></a></dt>
<dd><p>Determines the % of pixels that intersect
the border or perimeter of the image</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.save_image">
<span class="sig-name descname"><span class="pre">save_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cropped</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.save_image" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.process_sheets.Image.extract_contours">
<span class="sig-name descname"><span class="pre">extract_contours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_cropped</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.Image.extract_contours" title="Permalink to this definition"></a></dt>
<dd><p>Finds, extracts and saves ROIs from sheets
Saves filename, width, height, and cutoff to lists for a df</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>show_cropped</strong> (<em>bool</em>) – whether to show the ROI regions</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.process_sheets.run">
<span class="sig-prename descclassname"><span class="pre">cocpit.process_sheets.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">open_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_original</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_dilate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cropped</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.run" title="Permalink to this definition"></a></dt>
<dd><p>main method calls</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.process_sheets.make_df">
<span class="sig-prename descclassname"><span class="pre">cocpit.process_sheets.</span></span><span class="sig-name descname"><span class="pre">make_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_widths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_heights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoffs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.make_df" title="Permalink to this definition"></a></dt>
<dd><p>creates df with original image and particle widths, heights, and % cutoff
writes to csv file for each campaign</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.process_sheets.send_message">
<span class="sig-prename descclassname"><span class="pre">cocpit.process_sheets.</span></span><span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.send_message" title="Permalink to this definition"></a></dt>
<dd><p>use twilio to receive a text when the processing has finished!
register for an account and then:
add ACCOUNT_SID, AUTH_TOKEN, and PHONE_NUMBER to a .env file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.process_sheets.main">
<span class="sig-prename descclassname"><span class="pre">cocpit.process_sheets.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sheet_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_original</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_dilate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cropped</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.process_sheets.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-cocpit.run_model">
<span id="cocpit-run-model-module"></span><h2>cocpit.run_model module<a class="headerlink" href="#module-cocpit.run_model" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="cocpit.run_model.test_loader">
<span class="sig-prename descclassname"><span class="pre">cocpit.run_model.</span></span><span class="sig-name descname"><span class="pre">test_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">open_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.run_model.test_loader" title="Permalink to this definition"></a></dt>
<dd><p>Create test dataloader</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>open_dir</strong> (<em>str</em>) – path to the image directory</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – df with file names</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.run_model.test_predictions">
<span class="sig-prename descclassname"><span class="pre">cocpit.run_model.</span></span><span class="sig-name descname"><span class="pre">test_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.run_model.test_predictions" title="Permalink to this definition"></a></dt>
<dd><p>Make predictions from loader</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loader</strong> (<em>torch.loader.Loader</em>) – test loader</p></li>
<li><p><strong>model</strong> (<em>torch.model.Model</em>) – model used to make predictions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of class probabilities for all images
top_class (List[str]): highest class probability for all images</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class_probs (DefaultDict[str, List[float])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.run_model.percent_category">
<span class="sig-prename descclassname"><span class="pre">cocpit.run_model.</span></span><span class="sig-name descname"><span class="pre">percent_category</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.run_model.percent_category" title="Permalink to this definition"></a></dt>
<dd><p>Find # and % of a class out of all images</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pdf.DataFrame</em>) – dataframe of predictions</p></li>
<li><p><strong>category</strong> (<em>str</em>) – the class to be considered</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.run_model.send_message">
<span class="sig-prename descclassname"><span class="pre">cocpit.run_model.</span></span><span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.run_model.send_message" title="Permalink to this definition"></a></dt>
<dd><ul class="simple">
<li><p>Use twilio to receive a text when the model has finished running</p></li>
<li><p>Add ACCOUNT_SID, AUTH_TOKEN, and PHONE_NUMBER to a .env file</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.run_model.main">
<span class="sig-prename descclassname"><span class="pre">cocpit.run_model.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">open_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.run_model.main" title="Permalink to this definition"></a></dt>
<dd><p>Classifies unseen images and appends classification to dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – df of filenames</p></li>
<li><p><strong>open_dir</strong> (<em>str</em>) – directory where the test images live</p></li>
<li><p><strong>model</strong> (<em>torch.model.Model</em>) – model to be used for classification</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>df with predictions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>df (pd.DataFrame)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cocpit.runner">
<span id="cocpit-runner-module"></span><h2>cocpit.runner module<a class="headerlink" href="#module-cocpit.runner" title="Permalink to this headline"></a></h2>
<p>train the CNN model(s)</p>
<dl class="py function">
<dt class="sig sig-object py" id="cocpit.runner.determine_phases">
<span class="sig-prename descclassname"><span class="pre">cocpit.runner.</span></span><span class="sig-name descname"><span class="pre">determine_phases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.runner.determine_phases" title="Permalink to this definition"></a></dt>
<dd><p>determine if there is both a training and validation phase</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>either training or training and validation phase</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cocpit.runner.main">
<span class="sig-prename descclassname"><span class="pre">cocpit.runner.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kfold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.runner.main" title="Permalink to this definition"></a></dt>
<dd><p>Trains and validates a model across epochs, phases, and batches</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloaders</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>torch.utils.data.DataLoader</em><em>]</em>) – training and validation dict that loads images with sampling procedure</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.SGD</em>) – an algorithm that modifies the attributes of the neural network</p></li>
<li><p><strong>model</strong> (<em>torch.nn.parallel.data_parallel.DataParallel</em>) – saved and loaded model</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – max number of epochs to train and validate</p></li>
<li><p><strong>model_name</strong> (<em>str</em>) – name of model architecture</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – number of images read into memory at a time</p></li>
<li><p><strong>kfold</strong> (<em>int</em>) – number of k-folds used in resampling procedure</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cocpit.timing">
<span id="cocpit-timing-module"></span><h2>cocpit.timing module<a class="headerlink" href="#module-cocpit.timing" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.timing.EpochTime">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.timing.</span></span><span class="sig-name descname"><span class="pre">EpochTime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">since_total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since_epoch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.timing.EpochTime" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>time one epoch, all epochs, and write to csv</p>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.timing.EpochTime.write_times">
<span class="sig-name descname"><span class="pre">write_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kfold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.timing.EpochTime.write_times" title="Permalink to this definition"></a></dt>
<dd><p>write time to train with respective modelname, epoch, and kfold to file</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.timing.EpochTime.print_time_all_epochs">
<span class="sig-name descname"><span class="pre">print_time_all_epochs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.timing.EpochTime.print_time_all_epochs" title="Permalink to this definition"></a></dt>
<dd><p>print time it took for all epochs to train</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.timing.EpochTime.print_time_one_epoch">
<span class="sig-name descname"><span class="pre">print_time_one_epoch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.timing.EpochTime.print_time_one_epoch" title="Permalink to this definition"></a></dt>
<dd><p>print time it took for one epoch to complete</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.train">
<span id="cocpit-train-module"></span><h2>cocpit.train module<a class="headerlink" href="#module-cocpit.train" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.train.Train">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.train.</span></span><span class="sig-name descname"><span class="pre">Train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kfold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">CrossEntropyLoss()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.train.Train" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cocpit.performance_metrics.Metrics" title="cocpit.performance_metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">cocpit.performance_metrics.Metrics</span></code></a></p>
<p>Perform training methods on batched dataset</p>
<dl class="py method">
<dt class="sig sig-object py" id="cocpit.train.Train.label_counts">
<span class="sig-name descname"><span class="pre">label_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_cnts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.train.Train.label_counts" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the # of labels per batch to ensure weighted random sampler is correct</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_cnts</strong> (<em>np.ndarray</em>) – number of labels per class from all batches before</p></li>
<li><p><strong>labels</strong> (<em>torch.Tensor</em>) – class/label names</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sum of label counts from prior batches plus current batch</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>label_cnts (List[int])</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.train.Train.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.train.Train.forward" title="Permalink to this definition"></a></dt>
<dd><p>perform forward operator and make predictions</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.train.Train.iterate_batches">
<span class="sig-name descname"><span class="pre">iterate_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_label_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.train.Train.iterate_batches" title="Permalink to this definition"></a></dt>
<dd><p>iterate over a batch in a dataloader and train</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_label_count</strong> (<em>bool</em>) – if True print class counts when iterating batches</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.train.Train.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.train.Train.run" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cocpit.validate">
<span id="cocpit-validate-module"></span><h2>cocpit.validate module<a class="headerlink" href="#module-cocpit.validate" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cocpit.validate.Validation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cocpit.validate.</span></span><span class="sig-name descname"><span class="pre">Validation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kfold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">CrossEntropyLoss()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cocpit.performance_metrics.Metrics" title="cocpit.performance_metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">cocpit.performance_metrics.Metrics</span></code></a></p>
<p>Perform validation methods on batched dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val_best_acc</strong> – (float): best validation accuracy of the model up to the given batch</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="cocpit.validate.Validation.all_preds">
<span class="sig-name descname"><span class="pre">all_preds</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#cocpit.validate.Validation.all_preds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cocpit.validate.Validation.all_labels">
<span class="sig-name descname"><span class="pre">all_labels</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#cocpit.validate.Validation.all_labels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.validate.Validation.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation.predict" title="Permalink to this definition"></a></dt>
<dd><p>make predictions</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.validate.Validation.append_preds">
<span class="sig-name descname"><span class="pre">append_preds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation.append_preds" title="Permalink to this definition"></a></dt>
<dd><p>save each batch prediction and labels for plots</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.validate.Validation.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation.save_model" title="Permalink to this definition"></a></dt>
<dd><p>save/load best model weights after improvement in val accuracy</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.validate.Validation.reduce_lr">
<span class="sig-name descname"><span class="pre">reduce_lr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation.reduce_lr" title="Permalink to this definition"></a></dt>
<dd><p>reduce learning rate upon plateau in epoch validation accuracy</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.validate.Validation.iterate_batches">
<span class="sig-name descname"><span class="pre">iterate_batches</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation.iterate_batches" title="Permalink to this definition"></a></dt>
<dd><p>iterate over a batch in a dataloader and make predictions</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.validate.Validation.confusion_matrix">
<span class="sig-name descname"><span class="pre">confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation.confusion_matrix" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>log a confusion matrix to comet ml after the last epoch</dt><dd><ul class="simple">
<li><p>found under the graphics tab</p></li>
</ul>
</dd>
</dl>
<p>if using kfold, it will concatenate all validation dataloaders
if not using kfold, it will only plot the validation dataset (e.g, 20%)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>norm</strong> (<em>str</em>) – ‘true’, ‘pred’, or None.
Normalizes confusion matrix over the true (rows),
predicted (columns) conditions or all the population.
If None, confusion matrix will not be normalized.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.validate.Validation.classification_report">
<span class="sig-name descname"><span class="pre">classification_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation.classification_report" title="Permalink to this definition"></a></dt>
<dd><p>create classification report from sklearn
add model name and fold iteration to the report</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fold</strong> (<em>int</em>) – which fold to use in resampling procedure</p></li>
<li><p><strong>model_name</strong> (<em>str</em>) – name of the models</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cocpit.validate.Validation.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cocpit.validate.Validation.run" title="Permalink to this definition"></a></dt>
<dd><p>Run model on validation data and calculate metrics
Reset acc, loss, labels, and predictions for each epoch, model, phase, and fold</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cocpit">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cocpit" title="Permalink to this headline"></a></h2>
<p>COCPIT package:</p>
<p>Classification of Cloud Particle Imagery and Thermodynamics</p>
<section id="modules">
<h3>modules:<a class="headerlink" href="#modules" title="Permalink to this headline"></a></h3>
<dl>
<dt>add_date:</dt><dd><ul class="simple">
<li><p>add a column to the dataframes for the date from the filename</p></li>
</ul>
</dd>
<dt>auto_str:</dt><dd><ul class="simple">
<li><p>automatically implements a string representation for classes</p></li>
</ul>
<p>instead of memory id
- finds all attributes of the class
- called with str(instance)</p>
</dd>
<dt>config-sample:</dt><dd><ul class="simple">
<li><p>holds all user-defined variables</p></li>
<li><p>treated as global and used across modules</p></li>
<li><p>paths are to be modified for each user</p></li>
<li><p>rename config-sample to config.py when running code</p></li>
</ul>
</dd>
<dt>data_loaders:</dt><dd><ul class="simple">
<li><p>retrives data loaders from Pytorch for training and validation data</p></li>
<li><p>includes weighted and unweighted sampling</p></li>
<li><p>modified to append path to image (including class folder)</p></li>
</ul>
</dd>
<dt>fold_setup:</dt><dd><ul class="simple">
<li><p>setup training and validation indices for labels and data based on k-fold cross validation</p></li>
</ul>
</dd>
<dt>geometry:</dt><dd><ul class="simple">
<li><p>calculates particle geometrical attributes</p></li>
</ul>
</dd>
<dt>geometry_runner:</dt><dd><ul class="simple">
<li><p>holds the main Image class for image manipulation using opencv</p></li>
</ul>
</dd>
<dt>gui_label:</dt><dd><ul class="simple">
<li><p>an ipywidget interface for creating a training dataset</p></li>
<li><p>buttons to choose a label and move an image into that dir</p></li>
<li><p>called in notebooks/label.ipynb</p></li>
</ul>
</dd>
<dt>gui_wrong:</dt><dd><ul class="simple">
<li><p>an ipywidget interface for labeling incorrect predictions from a validation dataloader</p></li>
<li><p>should the model be right, images are moved within the training dataset</p></li>
<li><p>called in notebooks/move_wrong_predictions.ipynb</p></li>
</ul>
</dd>
<dt>gui:</dt><dd><ul class="simple">
<li><p>an ipywidget interface for nested classification that separates images within a class</p></li>
<li><p>used on the entire training dataset</p></li>
<li><p>called in notebooks/gui_check_dataset_one_class.ipynb</p></li>
</ul>
</dd>
<dt>image_stats:</dt><dd><ul class="simple">
<li><p>find the #/% of cutoff particles after removing blurry, fragmented, and spherical drops</p></li>
<li><p>used as a separate script (external - not being called in __main__.py)</p></li>
</ul>
</dd>
<dt>model_config:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>model configurations for:</dt><dd><ul>
<li><p>dropout</p></li>
<li><p>device settings</p></li>
<li><p>parameters to update</p></li>
<li><p>checking label counts within a batch</p></li>
<li><p>normalization values for transformations</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>models:</dt><dd><ul class="simple">
<li><p>defines torchvision models</p></li>
</ul>
</dd>
<dt>performance_metrics:</dt><dd><ul class="simple">
<li><p>holds epoch and batch metrics for both the training and validation datasets</p></li>
<li><p>inherited by train and validation classes</p></li>
<li><p>logs metrics to console and/or comet-ml interface (see config.py to turn on)</p></li>
<li><p>writes metrics to csv’s defined in config.py</p></li>
</ul>
</dd>
<dt>predictions:</dt><dd><ul class="simple">
<li><p>holds methods regarding making model predictions</p></li>
<li><p>for confusion matrices and running the model on new data</p></li>
</ul>
</dd>
<dt>process_sheets:</dt><dd><ul class="simple">
<li><p>extracts single images from the muliple images per frame or sheet</p></li>
<li><p>saves single images to a directory for later creation of the database</p></li>
</ul>
</dd>
<dt>run_model:</dt><dd><p>-classifies good ice images through a convolutional neural network that
was presaved or built in build_ML_model
-transforms, makes predictions, and appends classification to dataframe</p>
</dd>
<dt>runner:</dt><dd><ul class="simple">
<li><p>iterates over epochs, batch sizes, and phases and calls training methods</p></li>
</ul>
<p>and validation methods</p>
</dd>
<dt>timing:</dt><dd><ul class="simple">
<li><p>time one epoch, all epochs, and write to csv</p></li>
</ul>
</dd>
<dt>setup_training:</dt><dd><ul class="simple">
<li><p>train model with k folds for cross validation across samples called in __main__.py</p></li>
<li><p>runner class to get dataloaders and set up cross validation</p></li>
</ul>
</dd>
<dt>train:</dt><dd><ul class="simple">
<li><p>execution of running a model across batches for training set only</p></li>
<li><p>outputs performance metrics during training</p></li>
</ul>
</dd>
<dt>validate:</dt><dd><ul class="simple">
<li><p>execution of running a model across batches for validation set only</p></li>
<li><p>outputs performance metrics and saves confusion matrix and classification report</p></li>
</ul>
</dd>
</dl>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Vanessa Przybylo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
